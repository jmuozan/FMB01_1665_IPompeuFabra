<!DOCTYPE html>
<html lang="ca">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300..700&display=swap" rel="stylesheet">
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.15.1/css/all.css"
      integrity="sha384-vp86vTRFVJgpjF9jiIGPEEqYqlDwgyBgEF109VFjmqGmIY/Y4HV4d3Gp2irVfcrp"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../../../styles/styles.css" />
    <title>MediaPipe</title>
    <style>
      .camera-content {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 27px;
        min-height: calc(100vh - 140px);
      }

      .camera-title {
        font-size: 2rem;
        font-weight: 500;
        color: rgba(0, 0, 0, 0.65);
        margin-bottom: 2rem;
        margin-top: 2rem;
      }

      .back-link {
        display: inline-block;
        margin-bottom: 1.5rem;
        color: #939393;
        text-decoration: none;
        font-weight: 400;
        font-size: 14px;
        transition: all 0.2s ease;
      }

      .back-link:hover {
        color: rgba(0, 0, 0, 0.65);
      }

      /* Control Panel */
      .control-panel {
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 3px;
        padding: 1.5rem;
        margin-bottom: 2rem;
      }

      .control-group {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        align-items: center;
        margin-bottom: 1rem;
      }

      .control-group:last-child {
        margin-bottom: 0;
      }

      .btn {
        padding: 8px 16px;
        border: 1px solid;
        border-radius: 3px;
        font-size: 14px;
        font-weight: 400;
        cursor: pointer;
        transition: all 0.2s ease;
        font-family: inherit;
        background: transparent;
      }

      .btn-primary {
        border-color: #0366d6;
        color: #0366d6;
      }

      .btn-primary:hover:not(:disabled) {
        background: #0366d6;
        color: white;
      }

      .btn-success {
        border-color: #28a745;
        color: #28a745;
      }

      .btn-success:hover:not(:disabled) {
        background: #28a745;
        color: white;
      }

      .btn-danger {
        border-color: #dc3545;
        color: #dc3545;
      }

      .btn-danger:hover:not(:disabled) {
        background: #dc3545;
        color: white;
      }

      .btn-secondary {
        border-color: #939393;
        color: #939393;
      }

      .btn-secondary:hover:not(:disabled) {
        background: #939393;
        color: white;
      }

      .btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }

      .detection-options {
        display: flex;
        gap: 1.5rem;
        flex-wrap: wrap;
      }

      .checkbox-label {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        cursor: pointer;
        font-size: 14px;
        color: rgba(0, 0, 0, 0.65);
      }

      .checkbox-label input[type="checkbox"] {
        cursor: pointer;
      }

      /* Video Container */
      .video-container {
        position: relative;
        margin: 0 auto 2rem;
        background: #000;
        border-radius: 3px;
        overflow: hidden;
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .video-wrapper {
        position: relative;
        width: 100%;
        padding-bottom: 56.25%; /* 16:9 aspect ratio - will be dynamically adjusted */
      }

      .video-wrapper.portrait {
        padding-bottom: 133.33%; /* 3:4 aspect ratio for portrait */
        max-width: 600px;
        margin: 0 auto;
      }

      #videoElement {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      #canvasElement {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      .status-indicator {
        position: absolute;
        top: 1rem;
        right: 1rem;
        padding: 0.5rem 1rem;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border-radius: 20px;
        font-size: 0.9rem;
        z-index: 10;
      }

      .status-indicator.recording {
        background: rgba(220, 53, 69, 0.9);
        animation: pulse 1.5s infinite;
      }

      @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
      }

      .recording-time {
        position: absolute;
        top: 1rem;
        left: 1rem;
        padding: 0.5rem 1rem;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border-radius: 20px;
        font-size: 0.9rem;
        z-index: 10;
        display: none;
        font-variant-numeric: tabular-nums;
      }

      .recording-time.active {
        display: block;
      }

      /* Info Box */
      .info-box {
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-left: 2px solid #0366d6;
        padding: 1rem 1.5rem;
        margin-top: 2rem;
        border-radius: 3px;
      }

      .info-box h3 {
        margin-top: 0;
        font-size: 1rem;
        font-weight: 500;
        color: rgba(0, 0, 0, 0.65);
      }

      .info-box ul {
        margin-bottom: 0;
        line-height: 27px;
        font-size: 14px;
        color: rgba(0, 0, 0, 0.65);
      }

      /* Responsive */
      @media (max-width: 1023px) {
        .camera-content {
          padding: 0 20px;
        }

        .control-panel {
          padding: 1rem;
        }

        .control-group {
          justify-content: center;
        }

        .detection-options {
          gap: 1rem;
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <nav class="navbar">
      <a href="../../../index.html" class="navbar__logo">FMB0_1665</a>
      <div class="navbar__bars">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.5"/>
        </svg>
      </div>
      <div class="navbar__menu">
        <a href="../ra1/ra1.html" class="navbar__menu--links">RA1</a>
        <a href="../ra2/ra2.html" class="navbar__menu--links">RA2</a>
        <a href="../ra3/" class="navbar__menu--links">RA3</a>
        <a href="#" class="navbar__menu--links navbar__menu--disabled">RA4</a>
        <a href="#" class="navbar__menu--links navbar__menu--disabled">RA5</a>
        <a href="#" class="navbar__menu--links navbar__menu--disabled">RA6</a>
        <a href="./index.html" class="navbar__menu--links">Extra</a>
        <a href="../../info.html" class="navbar__menu--links">Info</a>
      </div>
    </nav>

    <div class="camera-content">
      <a href="./index.html" class="back-link">← Tornar</a>

      <h1 class="camera-title">MediaPipe Camera</h1>

      <!-- Control Panel -->
      <div class="control-panel">
        <div class="control-group">
          <button id="startButton" class="btn btn-primary">Iniciar</button>
          <button id="stopButton" class="btn btn-secondary" disabled>Aturar</button>
          <button id="switchCameraButton" class="btn btn-secondary" disabled style="display: none;">Canviar càmera</button>
          <button id="recordButton" class="btn btn-success" disabled>Gravar</button>
          <button id="stopRecordButton" class="btn btn-danger" disabled>Stop</button>
          <button id="downloadButton" class="btn btn-secondary" disabled>Descarregar</button>
        </div>

        <div class="control-group detection-options">
          <label class="checkbox-label">
            <input type="checkbox" id="poseDetection" checked>
            <span>Pose</span>
          </label>
          <label class="checkbox-label">
            <input type="checkbox" id="handDetection" checked>
            <span>Mans</span>
          </label>
          <label class="checkbox-label">
            <input type="checkbox" id="faceDetection" checked>
            <span>Cara</span>
          </label>
        </div>
      </div>

      <!-- Video Container -->
      <div class="video-container">
        <div class="video-wrapper">
          <video id="videoElement" autoplay playsinline></video>
          <canvas id="canvasElement"></canvas>
          <div id="statusIndicator" class="status-indicator">Càmera aturada</div>
          <div id="recordingTime" class="recording-time">00:00</div>
        </div>
      </div>

    </div>

    <div class="footer">
      <div class="footer__container">
        <div class="footer__left">
          <p class="footer__copyright">
            © 2025 Jorge Muñoz Zanón. Tot el contingut d'esta pàgina està llicenciat sota
            <a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer">Llicència MIT</a>
            tret que s'indique el contrari.
          </p>
        </div>
        <div class="footer__right">
          <div class="footer__social">
            <a href="https://github.com/jmuozan/FMB01_1665_IPompeuFabra" target="_blank" rel="noopener noreferrer" class="footer__social--link">
              <i class="fab fa-github"></i>
            </a>
            <a href="https://www.linkedin.com/in/jorgemunozzanon/" target="_blank" rel="noopener noreferrer" class="footer__social--link">
              <i class="fab fa-linkedin"></i>
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- MediaPipe Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js" crossorigin="anonymous"></script>

    <script src="./scripts/mediapipe-app.js"></script>
    <script src="../../../js/menu.js"></script>
  </body>
</html>
